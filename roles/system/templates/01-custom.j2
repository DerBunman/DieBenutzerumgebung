#!/usr/bin/env zsh
# =====================================
# << THIS FILE IS MANAGED BY ANSIBLE >>
# =====================================
#
# DO NOT EDIT THIS FILE - CHANGES WILL BE OVERWRITTEN
# INSTEAD CHANGE THIS FILE IN THE ANSIBLE REPOSITORY.

echo "{{ "\u001b[33m\033[1m" }}"
cat | figlet << EOF
{{ ansible_hostname }}
EOF
echo "{{ "\033[0m" }}"

MEM_TOTAL="$(free -m | grep ^Mem | tr -s ' ' | cut -d ' ' -f 2)"
MEM_FREE="$(free -m | grep ^Mem | tr -s ' ' | cut -d ' ' -f 3)"

cat << EOF
  {{ "\033[1m" }}Host:{{ "\033[0m" }}
    {{ "\033[1m" }}Hostname:{{ "\033[0m" }} {{ ansible_hostname | default("-") }} ({{ ansible_fqdn | default("-") }})
    {{ "\033[1m" }}CPU:{{ "\033[0m" }}      {{ ansible_processor_count }}x$(grep "model name" /proc/cpuinfo | head -n1 | cut -d: -f2) ({{ ansible_processor_cores }} cores)
    {{ "\033[1m" }}Kernel:{{ "\033[0m" }}   $(uname --kernel-release)
    {{ "\033[1m" }}Distri:{{ "\033[0m" }}   {{ ansible_distribution }} {{ ansible_distribution_version }}

    {{ "\033[1m" }}IPv4:{{ "\033[0m" }}     {{ ansible_default_ipv4.address | default("-") }}
    {{ "\033[1m" }}IPv6:{{ "\033[0m" }}     {{ ansible_default_ipv6.address | default("-") }}

    {{ "\033[1m" }}Memory:{{ "\033[0m" }}   $MEM_FREE/$MEM_TOTAL MiB free
    {{ "\033[1m" }}RootFS:{{ "\033[0m" }}   ${$(df --output="size" -h /|tail -n1)//[[:space:]]} free: ${$(df --output="avail" -h /|tail -n1)//[[:space:]]}
    {{ "\033[1m" }}Uptime:{{ "\033[0m" }}   $(uptime --pretty|sed 's/^up //') ($(uptime -s))
    {{ "\033[1m" }}Load:{{ "\033[0m" }}     $(uptime | grep -o "[0-9][0-9,\. ]*$")

EOF
